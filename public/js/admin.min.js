if("undefined"==typeof jQuery)throw new Error("necesita jQuery");function _iniciar(){"use strict";$.Admin.cookies={set:function(cname,cvalue,exdays){var d=new Date;d.setTime(d.getTime()+24*exdays*60*60*1e3);var expires="expires="+d.toUTCString();document.cookie=cname+"="+cvalue+";"+expires+";path=/"},get:function(cname){for(var name=cname+"=",ca=document.cookie.split(";"),i=0;i<ca.length;i++){for(var c=ca[i];" "==c.charAt(0);)c=c.substring(1);if(0==c.indexOf(name))return c.substring(name.length,c.length)}return""},delete:function(cname){var _this=this;this.get(cname)&&(_d("entra"),document.cookie=cname+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/")},check:function(cookie){var _this=this;return this.get(cookie)}},$.Admin.flash={opciones:{timeout:2e4,position:"topRight",message:""},iniciar:function(){var _this=this},info:function(msj){var _this=this;msj&&(this.opciones.message=msj,iziToast.info(this.opciones))},error:function(msj){var _this=this;msj&&(this.opciones.message=msj,iziToast.error(this.opciones))}},$.Admin.flatpickr={opciones:{dateFormat:"d/m/Y",locale:{firstDayOfWeek:1,weekdays:{shorthand:["Do","Lu","Ma","Mi","Ju","Vi","Sa"],longhand:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"]},months:{shorthand:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Оct","Nov","Dic"],longhand:["Enero","Febreo","Мarzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"]}},inline:!1},iniciar:function(){var _this=this;$(".fechahora").length&&(this.opciones.dateFormat="d-m-Y H:i",this.opciones.enableTime=!0,$(".fechahora").flatpickr(this.opciones)),$(".fechas").length&&(this.opciones.dateFormat="d-m-Y",$(".fechas").flatpickr(this.opciones)),$(".horas").length&&(this.opciones.dateFormat="H:i",this.opciones.enableTime=!0,this.opciones.noCalendar=!0,$(".horas").flatpickr(this.opciones))},reiniciar:function(){if($('[data-toggle="datetimepicker"]').length){var _this=this;$('[data-toggle="datetimepicker"]').datetimepicker("destroy"),this.iniciar()}}},$.Admin.gmaps={input:null,autocomplete:null,geocoder:null,boton:null,event:null,marker:null,map:null,iniciar:function(){var _this=this;$("#ubicacion-gmaps").length&&(this.input=document.getElementById("ubicacion-gmaps"),this.autocompletado()),$("#mapa").length&&(this.input=document.getElementById("ubicacion-gmaps"),this.div=document.getElementById("mapa"),this.mapa())},autocompletado:function(){try{var _this=this;if(!_this.input)throw new Error("No se encontró el input para la función de autocompletado.");_this.autocomplete=new google.maps.places.Autocomplete(_this.input,{types:["geocode"]}),_this.autocomplete.setFields(["geometry"]),_this.autocomplete.addListener("place_changed",(function(){setTimeout(()=>{let place=_this.autocomplete.getPlace();if(place.geometry&&($("#lat").val(place.geometry.location.lat()),$("#lng").val(place.geometry.location.lng())),place.address_components){var address_components=place.address_components,components={};jQuery.each(address_components,(function(k,v1){jQuery.each(v1.types,(function(k2,v2){components[v2]=v1.long_name}))})),$("#street_name").val(components.route),$("#street_number").val(components.street_number),$("#country").val(components.country),$("#province").val(components.administrative_area_level_1),components.locality?$("#city").val(components.locality):components.sublocality?$("#city").val(components.sublocality):$("#city").val(components.administrative_area_level_2),$("#zipcode").val(components.postal_code)}},600)}))}catch(error){console.log(error)}},mapa:function(){try{var _this=this;if(!_this.input)throw new Error("No se encontró el input para la función de autocompletado.");if(!_this.div)throw new Error("No se encontró el div para el renderizado del mapa.");""!=_this.input.value&&(_this.event=new Event("change"),_this.input.dispatchEvent(_this.event));let lat=-32.9596572,lon=-60.646229;$("#lat").val()&&$("#lng").val()&&(lat=$("#lat").val(),lon=$("#lng").val());var latLng=new google.maps.LatLng(lat,lon);$("#lat").val(lat),$("#lng").val(lon),_this.map=new google.maps.Map(_this.div,{zoom:15,center:latLng}),_this.marker=new google.maps.Marker({position:latLng,title:"Dirección",map:_this.map,draggable:!0}),_this.geocoder=new google.maps.Geocoder,google.maps.event.addListener(_this.marker,"drag",(function(){$("#lat").val(_this.marker.getPosition().lat()),$("#lng").val(_this.marker.getPosition().lng())})),google.maps.event.addListener(_this.marker,"dragend",(function(){var latlng={lat:parseFloat(_this.marker.getPosition().lat()),lng:parseFloat(_this.marker.getPosition().lng())};_this.geocoder.geocode({location:latlng},(function(results,status){if("OK"===status)if(results[1]){var address_components=results[0].address_components,components={};jQuery.each(address_components,(function(k,v1){jQuery.each(v1.types,(function(k2,v2){components[v2]=v1.long_name}))})),$("#street_name").val(components.route),$("#street_number").val(components.street_number),$("#country").val(components.country),$("#province").val(components.administrative_area_level_1),components.locality?$("#city").val(components.locality):components.sublocality?$("#city").val(components.sublocality):$("#city").val(components.administrative_area_level_2),$("#zipcode").val(components.postal_code),$("#lat").val(results[0].geometry.location.lat()),$("#lng").val(results[0].geometry.location.lng()),$("#title").val(components.route+" "+_this.redondear(components.street_number))}else _d("No results found");else _d("Geocoder failed due to: "+status)}))})),_this.autocomplete=new google.maps.places.Autocomplete(_this.input),_this.autocomplete.bindTo("bounds",_this.map),_this.autocomplete.addListener("place_changed",(function(){_this.marker.setVisible(!1);var place=_this.autocomplete.getPlace();place.geometry?(place.geometry.viewport?_this.map.fitBounds(place.geometry.viewport):(_this.map.setCenter(place.geometry.location),_this.map.setZoom(17)),_this.marker.setIcon({url:place.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(35,35)}),_this.marker.setPosition(place.geometry.location),_this.marker.setVisible(!0),setTimeout(()=>{let place=_this.autocomplete.getPlace();if(place.geometry&&($("#lat").val(place.geometry.location.lat()),$("#lng").val(place.geometry.location.lng())),place.address_components){var address_components=place.address_components,components={};jQuery.each(address_components,(function(k,v1){jQuery.each(v1.types,(function(k2,v2){components[v2]=v1.long_name}))})),$("#street_name").val(components.route),$("#street_number").val(components.street_number),$("#country").val(components.country),$("#province").val(components.administrative_area_level_1),components.locality?$("#city").val(components.locality):components.sublocality?$("#city").val(components.sublocality):$("#city").val(components.administrative_area_level_2),$("#zipcode").val(components.postal_code)}},600)):_d("No existe lugar para esa búsqueda")}))}catch(error){console.log(error)}},mapa_estatico:function(){try{var _this=this;if(!this.div)throw new Error("No se encontró el div para el renderizado del mapa.");if(!parseFloat(this.div.dataset.lat))throw new Error("La latitud esta mal");if(!parseFloat(this.div.dataset.lng))throw new Error("La longitud esta mal");let title=this.div.dataset.title||"Dirección";const myLatLng={lat:parseFloat(this.div.dataset.lat),lng:parseFloat(this.div.dataset.lng)},map=new google.maps.Map(this.div,{zoom:15,center:myLatLng}),contentString="<p>"+title+"</p>",infowindow=new google.maps.InfoWindow({content:contentString}),marker=new google.maps.Marker({position:myLatLng,map:map,title:title});marker.addListener("click",()=>{infowindow.open(map,marker)})}catch(error){console.log(error)}}},$.Admin.select2={elementos:[],historico:!1,opciones:{language:"es",placeholder:"",allowClear:!0,dropdownParent:null,miembro_email:""},iniciar:function(){var _this=this;$(".select2").length&&$(".select2").each((function(i,e){let elemJquery=$(e),opciones=Object.create(_this.opciones);if(elemJquery.hasClass("select2-usuarios")){var rol=elemJquery.data("rol");opciones.ajax={url:HOST+"admin/api/getUsuarios",dataType:"json",delay:250,data:function(params){return{rol:rol||"",search:params.term,page:params.page||1}},processResults:function(data,params){return params.page=params.page||1,{results:data.items,pagination:{more:25*params.page<data.total_count}}},cache:!0},opciones.escapeMarkup=function(markup){return markup},opciones.minimumInputLength=3,opciones.templateResult=_this.formatResultado,opciones.templateSelection=_this.formatResultadoSelection}elemJquery.data("dropdownparent")&&(opciones.dropdownParent=$(elemJquery.data("dropdownparent"))),elemJquery.data("placeholder")&&(opciones.placeholder=elemJquery.data("placeholder")),_this.elementos.push(e),elemJquery.select2(opciones)}))},reiniciar:function(mantenerValor=!1){var _this=this;$(".select2").length&&this.elementos.forEach((function(e){$(e).hasClass("select2-hidden-accessible")&&(mantenerValor?$(e).select2("destroy"):$(e).select2("destroy").val(null))})),this.iniciar()},formatResultadoSelection:function(resultado){return resultado.text||"Selecciona una opción"},formatResultado:function(resultado){return resultado.loading?resultado.text:"<span>"+resultado.text+"</span>"}},$.Admin.summernote={iniciar:function(){$(".summernote-disabled").length&&$(".summernote-disabled").summernote("disable")}},$.Admin.sidebar={iniciar:function(){var opciones=$.Admin.opciones,opcion,opcion;(opciones.controlAccion=opciones.controlador+opciones.accion,(opcion=$(".sidebar-menu").find("."+opciones.controlAccion)).length)?(opcion.addClass("active"),this._padres(opcion)):(opcion=$(".sidebar-menu").find("."+opciones.controlador)).length&&(opcion.addClass("active"),this._padres(opcion))},_padres:function(opcion){let padres=opcion.parents("ul");padres.length&&padres.each((index,element)=>{$(element).hasClass("dropdown-menu")&&$(element).css("display","block")});let grupos=opcion.parents("li");grupos.length&&grupos.each((index,element)=>{$(element).hasClass("dropdown")&&$(element).addClass("active")})}},$.Admin.password={selector:$(".pwstrength"),iniciar:function(){var _this=this;this.selector.length&&this.selector.pwstrength({texts:["muy débil","débil","mediocre","fuerte","muy fuerte"]})}}}function _d(d,v){$.Admin.opciones.debug&&(m=d,(v||0===v||!1===v)&&(m=m+" : "+v),console.log(m))}function verImagen(url){var w=window.open();w.document.open(),w.document.write('<img src="'+url+'">'),w.document.close()}function isEmpty(x){return!x||(null==x||(null==x||(void 0===x||(void 0===x||(""===x||(" "===x||(0==x.length||!x.length)))))))}function validarForm(form){if(form){for(var value of form){let input=$(value);if(input.attr("required")&&!input.attr("disabled")&&!input.val()){let title=input.attr("title");return $.Master.flash.error("Debe completar el campo "+title),input.focus(),!1}}return!0}return!1}function copiar(texto){if(document.queryCommandSupported("copy")){var aux=document.createElement("input");aux.setAttribute("value",texto),document.body.appendChild(aux),aux.select(),document.execCommand("copy"),document.body.removeChild(aux),mensaje("Copiado!.")}else alert("Su navegador no tiene soporte para copiar.")}function mensaje(texto){iziToast.info({title:"Mensaje del sistema",message:texto})}$.Admin={},$.Admin.opciones={debug:!0,izi:{timeout:2e4,position:"topRight"}},"undefined"!=typeof AdminOpciones&&$.extend(!0,$.Admin.opciones,AdminOpciones),_iniciar(),$(window).on("load",(function(){"use strict";$(".input").hasClass("error")&&($(".error").parent().parent().addClass("has-error"),$(".error-message").css("color","#dd4b39"))})),$(document).ready((function(){$.Admin.sidebar.iniciar(),$.Admin.flash.iniciar(),$.Admin.select2.iniciar(),$.Admin.summernote.iniciar(),$.Admin.flatpickr.iniciar(),$.Admin.password.iniciar(),$.Admin.gmaps.iniciar()})),$(document).on("scroll",(function(e){})),$(window).on("resize",(function(e){}));